{% extends 'adminPortal/base.html' %}

{% block title %}
<title>
    Payment History
</title>
{% endblock %}

{% block content %}


<!-- Order History Start -->
<div class="pageWrapper">
    <div class="container-xxl pb-4 pt-2">
        <div class="container">


            <div class="text-center wow fadeInUp" data-wow-delay="0.1s">
                <h5 class="section-title ff-secondary text-center text-primary fw-normal mt-4">All Payouts</h5>
                <h5 class="mb-4">Payments For Next Payout</h5>
            </div>
            <!-- date range picker start -->
            <form method="post" action="{% url 'admin-portal:new-payout-payments' theatre.pk %}">
                {% csrf_token %}
                <div class="row mb-3">

                    <!-- div start here -->
                    <div class="col-md-12 col-lg-12 col-12">

                        <div class="shadow-lg bg-white p-3 mb-2">
                            <div class="row d-none">

                            </div>
                            <!-- added by kanika 5 dec -->
                            <div class="row justify-between g-4">
                                <div class="col-lg-6 col-md-6 col-sm-12">
                                    <div class="d-flex">
                                        <h6>
                                            Overview
                                        </h6>
                                        <span class="text-muted small ms-3">
                                            <i class="far fa-clock me-2"></i>
                                            7 mins ago
                                        </span>

                                        <a href="#" class="refreshIcon ms-4">
                                            <i class="fa fa-undo me-2" aria-hidden="true"></i> Refresh
                                        </a>
                                    </div>


                                </div>
                                <div
                                    class="col-lg-6 col-md-6 col-sm-12 text-end float-end text-start-sm float-start-sm">
                                    <a href="#" class="refreshIcon">
                                        <i class="far fa-clock me-2"></i> My Settlement Cycle
                                    </a>
                                    <span class="mx-3"> | </span>

                                    <a href="#" class="refreshIcon">
                                        Documentation <i class="fas fa-external-link-alt ms-2"></i>
                                    </a>
                                </div>
                                <hr>
                            </div>
                            <div class="row g-4">

                                <div class="col-lg-3 col-md-4 col-sm-12 br-right-1">
                                    <h6 class="text-muted">
                                        Settlement Amount <small><i class="fas fa-info-circle ms-2"></i></small>
                                    </h6>

                                    <p class="amountDetails fs-5">
                                        ₹ {{current_balance}}
                                    </p>

                                </div>

                                <div class="col-lg-3 col-md-4 col-sm-12 br-right-1">
                                    <h6 class="text-muted">
                                        Settlement Duration <small><i class="fas fa-info-circle ms-2"></i></small>
                                    </h6>

                                    <p class="text-muted">
                                        {{start_time}} - {{end_time}}
                                    </p>
                                </div>

                                <div class="col-lg-3 col-md-4 col-sm-12 br-right-1">
                                    <h6 class="text-muted">
                                        Pending Balance <small><i class="fas fa-info-circle ms-2"></i></small>
                                    </h6>

                                    <h6 class="text-info amountDetails fs-5">
                                        ₹ {{pending_amount}}
                                    </h6>
                                </div>

                                <div class="col-md-12 col-lg-3 col-sm-12">
                                    <div class="col-12">
                                        <button type="submit" class="btn btn-primary mt-3" id="submit-button"><i
                                                class="fa fa-filter me-2"></i>Generate Payout</button>
                                    </div>
                                </div>
                            </div>



                        </div>
                    </div>
                    <!-- div end here -->


                </div>
            </form>

            <div id="order-list" class="row">


                <div class="container-fluid">


                    <div class="table-responsive">
                        <table class="table custom-table">
                            <thead>
                                <tr>
                                    <th scope="col">
                                        S No.
                                    </th>
                                    <th scope="col" class="w-200 text-center">
                                        Time
                                    </th>
                                    <th scope="col" class="text-center">
                                        Amount
                                    </th>
                                    <th scope="col" class="text-center">
                                        Payment Method
                                    </th>
                                    <th scope="col" class="text-center">
                                        Seat
                                    </th>
                                    <th scope="col" class="text-center">
                                        settled
                                    </th>
                                    <th scope="col" class="text-center">
                                        Action
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for payment in payments %}
                                <tr>
                                    <th scope="row">
                                        {{forloop.counter}}
                                    </th>
                                    <td class="text-center">
                                        {{payment.time}}
                                    </td>
                                    <td class="text-center">
                                        ₹ <span class="amount">
                                            {{payment.amount}}
                                        </span>
                                    </td>
                                    <td class="text-center">
                                        {{payment.payment_method}}
                                    </td>
                                    <td class="text-center">
                                        {{payment.order.seat.row.hall.name}} ({{payment.order.seat.name}})
                                    </td>
                                    <td class="text-center">
                                        {% if payment.is_settled %}
                                        <span class="badge rounded-pill text-bg-success bg-success ms-3">settled</span>
                                        {% else %}
                                        <span class="badge rounded-pill text-bg-success bg-danger ms-3">unsettled</span>
                                        {% endif %}
                                    </td>
                                    <td class="text-center">
                                        <a href="{% url 'admin-portal:order-profile' payment.order.pk %}"> <i class="fas fa-eye text-primary"></i></a>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>

                        </table>

                    </div>
                </div>



            </div>
        </div>
    </div>
</div>

<!-- Order History End -->
{% endblock %}
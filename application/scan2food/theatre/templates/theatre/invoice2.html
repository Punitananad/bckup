<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    {% load static %}



    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">
    <link href="{% static 'assets/images/brand/Scan2FoodFabIcon.png' %}" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;600&family=Nunito:wght@600;700;800&family=Pacifico&display=swap"
        rel="stylesheet">

    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'assets/lib/daterangepicker/daterangepicker.css' %}">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="{% static 'assets/css/bootstrap.min.css' %}" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="{% static 'assets/css/style.css' %}" rel="stylesheet">
    <!-- <link href="{% static 'assets/css/style.css' %}" rel="stylesheet"> -->
    <!-- <link href="{% static 'assets/css/custom.css' %}" rel="stylesheet"> -->
    <link href="{% static 'assets/css/custom.css' %}" rel="stylesheet">
    <style>
        #stemp {
            height: 150px;
        }
    </style>


    <!-- PDF CONVERSION -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>



</head>

<body>

    <div class="container-xxl position-relative p-0" id="nav-area">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark px-4 px-lg-5 py-lg-0 nav-custom">
            <a href="" class="navbar-brand p-0">
                <a href="#" class="navbar-brand p-0">
                    <img src="{% static 'assets/images/brand/Scan2Food.png' %}" alt="Scan2Food Logo">
                </a>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
                <span class="fa fa-bars"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarCollapse">
                <div class="navbar-nav ms-auto py-0 pe-4">
                </div>

                <button class="btn btn-success py-2 px-4 mx-4 my-2" onclick="generatePdfFromHtml()">
                    <i class="fa fa-download me-2"></i> Download Invoice
                </button>


                <button class="btn btn-primary py-2 px-4 mx-4 my-2" onclick="printPage()"><i
                        class="fas fa-print me-2"></i>Print</button>
            </div>
        </nav>

    </div>


    <div class="container" id="agreement">
        <div class="row">
            <div class="col-6 mt-5">
                <h3 class="text-secondary">
                    Invoice
                </h3>
            </div>
            <div class="col-6 mt-5">
                <table style="width: 100%;">
                    <tr>
                        <td>
                            <img class="mx-4" src="{% static 'assets/images/brand/Scan2Food-whiteBG.png' %}"
                                alt="compny-logo" height="50px">
                        </td>
                    </tr>
                </table>
            </div>
            <div class="col-6">
                <table style="width: 100%;">
                    <tr>
                        <td>
                            Invoice Number
                        </td>
                        <th>
                            : TINSCAN{{order.pk}}
                        </th>
                    </tr>
                    <tr>

                        <td>
                            Date of issue
                        </td>
                        <th>
                            : {{order.payment.time.date}}
                        </th>
                    </tr>
                    <tr>
                        <td>
                            Place of supply
                        </td>
                        <th>
                            : {{order.seat.row.hall.theatre.address}}
                        </th>
                    </tr>
                    <tr>
                        <td>
                            Order ID
                        </td>
                        <th>
                            : {{order.pk}}
                        </th>
                    </tr>
                    <tr>

                        <td>
                            Customer GSTIN
                        </td>
                        <th>
                            : -
                        </th>
                    </tr>
                    <tr>

                        <td>
                            State
                        </td>
                        <th>
                            : {{order.seat.row.hall.theatre.gstdetails.gst_state}}
                        </th>
                    </tr>
                    <tr>
                        <td>
                            Customer Phone
                        </td>
                        <th>
                            : {{order.payment.phone_number}}
                        </th>
                    </tr>
                </table>
            </div>
            <div class="col-6 py-3">
                <table style="width: 100%;">
                    <tr>
                        <td>
                            Invoice issued by
                        </td>
                        <th>
                            : SCAN2FOOD
                        </th>
                    </tr>
                    <tr>
                        <td>
                            GSTIN
                        </td>
                        <th>
                            : 06BEBPA0763C1ZB
                        </th>
                    </tr>
                    <tr>
                        <td>
                            State
                        </td>
                        <th>
                            : Haryana
                        </th>
                    </tr>
                    <tr>
                        <td>
                            Company Address
                        </td>
                        <th>
                            : NEAR MAIN BAZAR Kalanaur Kalan Road
                        </th>
                    </tr>
                    <tr>
                        <td></td>
                        <th>
                            Kalanaur, Rohtak,
                        </th>
                    </tr>
                    <tr>
                        <td></td>
                        <th>
                            Haryana
                        </th>
                    </tr>
                    <tr>
                        <td></td>
                        <th> Kalanaur - 124113</th>
                    </tr>
                </table>

            </div>
            <div class="col-12">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Product Description</th>
                            <th>HSN Code</th>
                            <th>Qty</th>
                            <th>Discount</th>
                            <th>Taxable Amount</th>
                            <th colspan="2">CGST</th>
                            <th colspan="2">SGST</th>
                            <th colspan="2">IGST</th>
                            <th colspan="2">UT/Cess</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="width: 100px;">
                                Convenience fee/ internet handling fee</td>
                            <td>998313</td>
                            <td>1</td>
                            <td>0</td>
                            <td>{{taxable_amount}}</td>
                            <td>{{cgst_per}}%</td>
                            <td>{{cgst}}</td>
                            <td>{{cgst_per}}%</td>
                            <td>{{sgst}}</td>
                            <td>{{igst_per}}%</td>
                            <td>{{igst}}</td>
                            <td>0</td>
                            <td>0</td>
                            <td>{{total_amount}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="col-6">
            </div>
            <div class="col-6">
                <table style="width: 100%;">
                    <tbody>
                        <tr>
                            <td>
                                Total Amount before Tax :
                            </td>
                            <th class="text-end">
                                {{taxable_amount}}
                            </th>
                        </tr>
                        <tr>
                            <td>
                                Add CGST :
                            </td>
                            <th class="text-end">
                                {{cgst}}
                            </th>
                        </tr>
                        <tr>
                            <td>
                                Add SGST :
                            </td>
                            <th class="text-end">
                                {{sgst}}
                            </th>
                        </tr>
                        <tr>
                            <td>
                                Add IGST :
                            </td>
                            <th class="text-end">
                                {{igst}}
                            </th>
                        </tr>
                        <tr>
                            <td>
                                Add. UGST or Cess
                            </td>
                            <th class="text-end">
                                0.00
                            </th>
                        </tr>
                        <tr>
                            <th colspan="2">
                                <hr>
                            </th>
                        </tr>
                        <tr>
                            <th>
                                Total Amount : GST :
                            </th>
                            <th class="text-end">
                                {{gst}}
                            </th>
                        </tr>
                        <tr>
                            <th>
                                Total Amount after Tax :
                            </th>
                            <th class="text-end">
                                {{total_amount}}
                            </th>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="col-12">
                <hr>
            </div>
            <div class="col-6 mb-3">
                <table style="width: 100%;">
                    <tr>
                        <th>
                            Note:
                        </th>
                    </tr>
                    <tr>
                        <td>
                            Value of Rs.{{order.full_payment}}/- pertains to services provided by Theatre/Event
                            Organizer/
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Cinema & seat: {{order.seat.row.hall.theatre.name}}: {{order.seat.row.hall.name}}
                            ({{order.seat.name}}).
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Owner Name: {{order.seat.row.hall.theatre.owner_name}}
                        </td>
                    </tr>
                    <tr>
                        <td>
                            RCM : No
                        </td>
                    </tr>
                </table>
                <div>
                    <p>
                        Payment Refrence.
                    </p>
                    <ul>
                        <li>
                            Transaction Id & Amount of Payment: {{order.payment.pk}}, Rs. {{order.payment.amount}}/
                        </li>
                        <li>
                            Date & Time: {{order.payment.time}}
                        </li>
                        <li>
                            Mode of Payment: Online
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-6 mb-3">
                <table>
                    <tr>
                        <td>
                            Ceritified that the .particulars given above
                        </td>
                    </tr>
                    <tr>
                        <td>
                            are true and correct For SCAN2FOOD.
                        </td>
                    </tr>
                    <tr>
                        <td class="text-end">
                            <!-- <img src="https://pancardverify.in/static/images/signature.png" alt=""> -->
                        </td>
                    </tr>
                    <tr>
                        <td class="text-center">
                            <img id="stemp" src="{% static '/assets/stemp/scan2food-stemp.jpg' %}" alt="">
                        </td>
                    </tr>
                    <tr>
                        <td class="text-center">
                            Authorised Stemp & signature
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
    <!-- JavaScript Libraries -->
    <!-- JavaScript Libraries -->
    <script src="{% static 'assets/lib/tempusdominus/js/moment.min.js' %}"></script>
    <script src="{% static 'assets/lib/daterangepicker/daterangepicker.js' %}"></script>

    <!-- Template Javascript -->
    <script src="{% static 'assets/js/main.js' %}"></script>

    <!-- Load html2canvas manually -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- Load jsPDF UMD version -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>


    <script>
        function printPage() {
            document.getElementById('nav-area').style.display = 'none';
            window.print()
            document.getElementById('nav-area').style.display = 'block';
        }

        document.addEventListener('keydown', function (event) {
            if (event.ctrlKey && event.key === 'p' || event.ctrlKey && event.which === 80) { // Check for Ctrl+P (or older browsers)
                printPage()
            }
        });

        function generatePdfFromHtml() {
            const input = document.getElementById('agreement'); // Or document.body, or a specific div by ID

            html2canvas(input).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4'); // 'p' for portrait, 'mm' for units, 'a4' for page size

                const imgWidth = 210; // A4 width in mm
                const pageHeight = 297; // A4 height in mm
                const imgHeight = canvas.height * imgWidth / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;

                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;

                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }

                pdf.save('Invoice.pdf');
            });
        }

    </script>

</body>

</html>